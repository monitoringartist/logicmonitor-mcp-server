# ========================================
# LogicMonitor MCP Server Configuration
# ========================================
# Copy this file to .env and update with your actual values
# Environment variables take precedence over CLI flags
#
# Quick Start (Minimum Required):
#   LM_COMPANY=mycompany
#   LM_BEARER_TOKEN=your-token
#
# For remote servers, also set:
#   MCP_BEARER_TOKEN=your-static-token  (simple)
#   OR configure OAUTH_* variables       (advanced)

# ========================================
# LOGICMONITOR API (REQUIRED)
# ========================================

# Your LogicMonitor company/account name (subdomain)
# Example: if your portal is "mycompany.logicmonitor.com", use "mycompany"
# CLI flag: --lm-company
LM_COMPANY=your-company-name

# LogicMonitor API Bearer Token
# Generate at: Settings > Users & Roles > API Tokens
# Requires: API user with appropriate permissions
# CLI flag: --lm-bearer-token
LM_BEARER_TOKEN=your-bearer-token-here

# ========================================
# TRANSPORT OPTIONS
# ========================================

# Transport type: stdio, sse, or streamable-http
# CLI flag: -t, --transport
# Default: stdio
#
# Options:
#   - stdio: Standard I/O (default, for Claude Desktop and local CLI)
#   - sse: Server-Sent Events (for web/remote clients)
#   - streamable-http: Streamable HTTP (for advanced integrations)
MCP_TRANSPORT=stdio

# Server address for SSE/HTTP transports
# Format: host:port
# CLI flag: --address
# Default: localhost:3000
MCP_ADDRESS=localhost:3000

# Base path for the server (optional)
# CLI flag: --base-path
# Example: /api/v1
#MCP_BASE_PATH=/api

# Endpoint path for streamable-http transport
# CLI flag: --endpoint-path
# Default: /mcp
MCP_ENDPOINT_PATH=/mcp

# ========================================
# TLS/HTTPS CONFIGURATION (Optional)
# For SSE/HTTP transports only
# ========================================

# Path to TLS certificate file for HTTPS
# CLI flag: --server.tls-cert-file
# If both cert and key are configured, server uses HTTPS
# If unconfigured, server uses HTTP
#MCP_TLS_CERT_FILE=/path/to/cert.pem

# Path to TLS private key file for HTTPS
# CLI flag: --server.tls-key-file
# Both cert and key required to enable HTTPS
#MCP_TLS_KEY_FILE=/path/to/key.pem

# ========================================
# DEBUG AND LOGGING
# ========================================

# Enable debug mode with detailed logging
# CLI flag: --debug
# Options: true | false
# Default: false
MCP_DEBUG=false

# Log format
# CLI flag: --log-format
# Options:
#   - json: Machine-friendly JSON format (recommended for production)
#   - human: Human-friendly format with colors and emojis
# Default: human
MCP_LOG_FORMAT=human

# Log level
# CLI flag: --log-level
# Options: debug | info | warn | error
# Levels:
#   - debug: All messages (most verbose, includes API requests/responses)
#   - info: Informational messages and above (recommended)
#   - warn: Warnings and errors only
#   - error: Errors only (least verbose)
# Default: info
MCP_LOG_LEVEL=info

# ========================================
# TOOL CONFIGURATION
# ========================================

# Comma-separated list of enabled tools
# CLI flag: --enabled-tools
# Example: list_resources,get_resource,list_alerts,get_alert
# Default: all tools enabled (125 tools)
# Use case: Restrict available tools for security or simplicity
#MCP_ENABLED_TOOLS=list_resources,get_resource,list_alerts,get_alert

# Enable only read-only tools (list, get, search operations)
# CLI flag: --read-only
# Options: true | false
# Tool counts:
#   - true: 73 read-only tools (safer, recommended for production)
#   - false: 125 tools (73 read-only + 52 write operations)
# Default: true
MCP_READ_ONLY=true

# Disable search tools
# CLI flag: --disable-search
# Options: true | false
# Removes 3 search tools: search_resources, search_alerts, search_audit_logs
# Default: false
MCP_DISABLE_SEARCH=false

# ========================================
# MCP SERVER AUTHENTICATION (Required for SSE/HTTP transports)
# Choose at least one authentication method for remote access
# Not required for STDIO transport (local only)
# ========================================

# Static Bearer Token Authentication (Simpler option)
# CLI flag: --mcp-bearer-token
# A pre-shared secret token for authenticating MCP clients
# Clients must send: Authorization: Bearer <your-token>
#
# Generate secure token:
#   openssl rand -base64 32
#   OR
#   node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
#
# Use case: Simple authentication for internal/development use
# Can be used alongside OAuth - both methods work simultaneously
#MCP_BEARER_TOKEN=your-static-bearer-token-here

# ========================================
# OAUTH/OIDC AUTHENTICATION (Advanced option)
# More secure option for production environments
# Can be used alongside MCP_BEARER_TOKEN
# Supports multiple providers
# ========================================

# OAuth provider type
# Options: github | google | azure | okta | auth0 | custom
# Default: Not set (OAuth disabled)
# Leave commented to disable OAuth
#OAUTH_PROVIDER=github

# OAuth client credentials
# Obtain these from your OAuth provider's developer console
# Required if OAUTH_PROVIDER is set
#OAUTH_CLIENT_ID=your-oauth-client-id
#OAUTH_CLIENT_SECRET=your-oauth-client-secret

# OAuth session secret (for encrypting session cookies)
# Generate a strong random string for production:
#   openssl rand -hex 32
# Also accepts SESSION_SECRET for backward compatibility
#OAUTH_SESSION_SECRET=change-this-to-a-random-secure-string

# OAuth callback URL
# Must be registered with your OAuth provider
# Should match your server's public URL
# Default: http://{MCP_ADDRESS}/auth/callback
#OAUTH_CALLBACK_URL=http://localhost:3000/auth/callback

# OAuth scopes (comma-separated or space-separated)
# Different providers support different scopes
# Examples:
#   GitHub: user:email,read:user
#   Google: profile,email,openid
#   Azure: openid,profile,email,User.Read
#   Okta: openid,profile,email
#   Auth0: openid,profile,email
# Default: Provider-specific defaults
#OAUTH_SCOPE=user:email

# ========================================
# PROVIDER-SPECIFIC OAUTH CONFIGURATION
# ========================================

# --- GITHUB OAUTH (provider=github) ---
# Setup:
#   1. Go to: https://github.com/settings/developers
#   2. Click "New OAuth App"
#   3. Set Authorization callback URL to your OAUTH_CALLBACK_URL
# Recommended scopes: user:email, read:user
# Note: GitHub doesn't support refresh tokens in standard OAuth flow

# --- GOOGLE OAUTH (provider=google) ---
# Setup:
#   1. Go to: https://console.cloud.google.com/apis/credentials
#   2. Create OAuth 2.0 Client ID
#   3. Add your OAUTH_CALLBACK_URL to Authorized redirect URIs
# Recommended scopes: profile, email, openid
# Note: Enable Google+ API for user profile access

# --- AZURE AD (provider=azure) ---
# Setup:
#   1. Go to: https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps
#   2. Register new application
#   3. Add redirect URI to Authentication
# Recommended scopes: openid, profile, email, User.Read
# Azure tenant ID (common, organizations, consumers, or specific tenant ID)
#OAUTH_AZURE_TENANT_ID=common

# --- OKTA (provider=okta) ---
# Setup:
#   1. Go to Okta Admin Console
#   2. Create new OAuth application
#   3. Configure redirect URIs
# Recommended scopes: openid, profile, email
# Your Okta domain (e.g., dev-12345.okta.com)
#OAUTH_OKTA_DOMAIN=your-domain.okta.com

# --- AUTH0 (provider=auth0) ---
# Setup:
#   1. Go to Auth0 Dashboard
#   2. Create new application
#   3. Configure Allowed Callback URLs
# Recommended scopes: openid, profile, email
# Your Auth0 domain (e.g., yourapp.auth0.com or yourapp.us.auth0.com)
#OAUTH_AUTH0_DOMAIN=your-domain.auth0.com

# --- CUSTOM OAUTH PROVIDER (provider=custom) ---
# For custom OAuth2/OIDC providers
# All three endpoints are required for custom providers
#OAUTH_AUTHORIZATION_URL=https://provider.com/oauth2/authorize
#OAUTH_TOKEN_URL=https://provider.com/oauth2/token
#OAUTH_USER_PROFILE_URL=https://provider.com/oauth2/userinfo

# ========================================
# TOKEN REFRESH CONFIGURATION (OAuth only)
# ========================================

# Enable automatic token refresh in background
# Options: true | false
# Default: true
# Set to false to disable token refresh (tokens will expire naturally)
#OAUTH_TOKEN_REFRESH=true

# Token refresh buffer (minutes before expiry to trigger refresh)
# Default: 5 minutes
# Lower values = more aggressive refresh (less chance of expiry)
# Higher values = fewer refresh requests (but higher risk of expiry)
# Range: 1-60 minutes
#OAUTH_TOKEN_REFRESH_BUFFER=5

# ========================================
# ADVANCED SERVER OPTIONS (Optional)
# For SSE/HTTP transports only
# ========================================

# Node environment
# Options: development | production
# Affects logging, error messages, and security features
#NODE_ENV=development

# Base URL for OAuth callbacks and JWT audience
# Used for:
#   - Generating absolute URLs for OAuth redirects
#   - JWT token audience validation (RFC 8707)
# MUST match the URL that clients use to access the server
# Default: http://{MCP_ADDRESS}
# Example for production: https://mcp.example.com
#BASE_URL=http://localhost:3000

# JWT Secret for signing tokens
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# If not set, a random secret is generated (not recommended for production)
# Required for production deployments with multiple server instances
#JWT_SECRET=your-jwt-secret-key-here

# CORS Configuration
# Comma-separated list of allowed origins
# Use * for development (allows all origins)
# Specify exact domains for production security
# Default: * (allow all)
#ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://mcp.example.com

# Transport mode for multi-transport server
# Options: both | http-only | sse-only
# Default: both
# Use case: Restrict available transports for security
#TRANSPORT_MODE=both

# ========================================
# CONFIGURATION EXAMPLES
# ========================================

# Example 1: Local Development (STDIO with Claude Desktop)
# LM_COMPANY=mycompany
# LM_BEARER_TOKEN=xxxxx
# MCP_TRANSPORT=stdio
# MCP_READ_ONLY=true

# Example 2: Remote Server with Static Token
# LM_COMPANY=mycompany
# LM_BEARER_TOKEN=xxxxx
# MCP_TRANSPORT=sse
# MCP_ADDRESS=0.0.0.0:3000
# MCP_BEARER_TOKEN=your-secure-token
# MCP_READ_ONLY=true

# Example 3: Production with OAuth (GitHub)
# LM_COMPANY=mycompany
# LM_BEARER_TOKEN=xxxxx
# MCP_TRANSPORT=sse
# MCP_ADDRESS=0.0.0.0:443
# MCP_TLS_CERT_FILE=/etc/ssl/certs/server.crt
# MCP_TLS_KEY_FILE=/etc/ssl/private/server.key
# OAUTH_PROVIDER=github
# OAUTH_CLIENT_ID=xxxxx
# OAUTH_CLIENT_SECRET=xxxxx
# OAUTH_SESSION_SECRET=xxxxx
# BASE_URL=https://mcp.example.com
# NODE_ENV=production
# MCP_LOG_FORMAT=json
# MCP_READ_ONLY=true

# Example 4: Restricted Tools (Only Alerts)
# LM_COMPANY=mycompany
# LM_BEARER_TOKEN=xxxxx
# MCP_ENABLED_TOOLS=list_alerts,get_alert,acknowledge_alert,add_alert_note
# MCP_READ_ONLY=false
# MCP_DISABLE_SEARCH=true
